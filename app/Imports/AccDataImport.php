<?php

namespace App\Imports;

use App\Models\AccData;
use Maatwebsite\Excel\Concerns\ToModel;


use Illuminate\Validation\Rule;
use Illuminate\Support\Facades\Validator;
use Maatwebsite\Excel\Concerns\WithHeadingRow;
use Maatwebsite\Excel\Concerns\WithStartRow;
use Maatwebsite\Excel\Concerns\Importable;
use Maatwebsite\Excel\Concerns\WithValidation;
use Maatwebsite\Excel\Concerns\ToCollection;
use Maatwebsite\Excel\Validators\Failure;
use Maatwebsite\Excel\Concerns\SkipsOnFailure;
use Maatwebsite\Excel\Concerns\SkipsFailures;


use Log;
use Illuminate\Support\Collection;
use Illuminate\Support\Facades\DB;


class AccDataImport implements ToModel , WithStartRow,WithValidation
{
    /**
    * @param array $row
    *
    * @return \Illuminate\Database\Eloquent\Model|null
    */
    use Importable;
    protected $ID_DOC;

    public function __construct($ID_DOC) {
        $this->ID_DOC = $ID_DOC;
    }
    public function model(array $row)
    {                
        return new AccData([
            'doc_id'=>$row[0],  
            'sort_order'=>$row[1],  
            'brutto'=>$row[2],  
            'brutto_calc'=>$row[3], 
            'vat'=>$row[4], 
            'vat_pros'=>$row[5],    
            'accepted'=>$row[6],    
            'acceptor_id'=>$row[7], 
            'accepted_date'=>$row[8],   
            't1'=>$row[9],  
            't2'=>$row[10],  
            't3'=>$row[11],  
            't4'=>$row[12],  
            't5'=>$row[13],  
            't6'=>$row[14],  
            't7'=>$row[15],  
            't8'=>$row[16],  
            't9'=>$row[17],  
            't10'=>$row[18], 
            't11'=>$row[19], 
            't12'=>$row[20], 
            't13'=>$row[21], 
            't14'=>$row[22], 
            't15'=>$row[23], 
            't16'=>$row[24], 
            't17'=>$row[25], 
            't18'=>$row[26], 
            't19'=>$row[27], 
            't20'=>$row[28], 
            't21'=>$row[29], 
            't22'=>$row[30], 
            't23'=>$row[31], 
            't24'=>$row[32], 
            't25'=>$row[33], 
            't26'=>$row[34], 
            't27'=>$row[35], 
            't28'=>$row[36], 
            't29'=>$row[37], 
            't30'=>$row[38], 
            't31'=>$row[39], 
            't32'=>$row[40], 
            't33'=>$row[41], 
            't34'=>$row[42], 
            't35'=>$row[43], 
            't36'=>$row[44], 
            't37'=>$row[45], 
            't38'=>$row[46], 
            't39'=>$row[47], 
            't40'=>$row[48], 
            't41'=>$row[49], 
            't42'=>$row[50], 
            't43'=>$row[51], 
            't44'=>$row[52], 
            't45'=>$row[53], 
            't46'=>$row[54], 
            't47'=>$row[55], 
            't48'=>$row[56], 
            't49'=>$row[57], 
            't50'=>$row[58], 
            't51'=>$row[59], 
            't52'=>$row[60], 
            't53'=>$row[61], 
            't54'=>$row[62], 
            't55'=>$row[63], 
            't56'=>$row[64], 
            't57'=>$row[65], 
            't58'=>$row[66], 
            't59'=>$row[67], 
            't60'=>$row[68], 
            't61'=>$row[69], 
            't62'=>$row[70], 
            't63'=>$row[71], 
            't64'=>$row[72], 
            't65'=>$row[73], 
            't66'=>$row[74], 
            't67'=>$row[75], 
            't68'=>$row[76], 
            't69'=>$row[77], 
            't70'=>$row[78], 
            't71'=>$row[79], 
            't72'=>$row[80], 
            't73'=>$row[81], 
            't74'=>$row[82], 
            't75'=>$row[83], 
            't76'=>$row[84], 
            't77'=>$row[85], 
            't78'=>$row[86], 
            't79'=>$row[87], 
            't80'=>$row[88], 
            't81'=>$row[89], 
            't82'=>$row[90], 
            't83'=>$row[91], 
            't84'=>$row[92], 
            't85'=>$row[93], 
            'n1'=>$row[94],  
            'n2'=>$row[95],  
            'n3'=>$row[96],  
            'n4'=>$row[97],  
            'n5'=>$row[98],  
            'n6'=>$row[99],  
            'n7'=>$row[100],  
            'n8'=>$row[101],  
            'n9'=>$row[102],  
            'n10'=>$row[103], 
            'n11'=>$row[104], 
            'n12'=>$row[105], 
            'n13'=>$row[106], 
            'n14'=>$row[107], 
            'n15'=>$row[108], 
            'n16'=>$row[109], 
            'n17'=>$row[110], 
            'n18'=>$row[111], 
            'n19'=>$row[112], 
            'n20'=>$row[113], 
            'stamp_date'=>$row[114],  
            'stamp_uid'=>$row[115],   
            'net_sum'=>$row[116], 
            'net_calc'=>$row[117],    
            'layer'=>$row[118],   
            'reviewed'=>$row[119],    
            'reviewer_id'=>$row[120], 
            'reviewed_date'=>$row[121], 
            'ID_DOC'=>$this->ID_DOC
        ]);
    }


    /**
     * @return int
     */
    public function startRow(): int
    {
        return 2;
    }
    
    public function rules(): array
    {
        return [
            '0'=>'required|max:64',  
            '1'=>'required',  
            '2'=>'nullable|max:100',  
            '3'=>'nullable|max:100', 
            '4'=>'nullable|max:100', 
            '5'=>'nullable|max:100',    
            '6'=>'nullable',    
            '7'=>'nullable|max:60', 
            '8'=>'nullable',   
            '9'=>'nullable|max:20',  
            '10'=>'nullable|max:20',  
            '11'=>'nullable|max:20',  
            '12'=>'nullable|max:20',  
            '13'=>'nullable|max:20',  
            '14'=>'nullable|max:40',  
            '15'=>'nullable|max:40',  
            '16'=>'nullable|max:40',  
            '17'=>'nullable|max:40',  
            '18'=>'nullable|max:40', 
            '19'=>'nullable|max:40', 
            '20'=>'nullable|max:40', 
            '21'=>'nullable|max:40', 
            '22'=>'nullable|max:40', 
            '23'=>'nullable|max:40', 
            '24'=>'nullable|max:60', 
            '25'=>'nullable|max:60', 
            '26'=>'nullable|max:60', 
            '27'=>'nullable|max:60', 
            '28'=>'nullable|max:60', 
            '29'=>'nullable|max:60', 
            '30'=>'nullable|max:60', 
            '31'=>'nullable|max:60', 
            '32'=>'nullable|max:60', 
            '33'=>'nullable|max:60', 
            '34'=>'nullable|max:80', 
            '35'=>'nullable|max:80', 
            '36'=>'nullable|max:80', 
            '37'=>'nullable|max:80', 
            '38'=>'nullable|max:150', 
            '39'=>'nullable|max:50', 
            '40'=>'nullable|max:50', 
            '41'=>'nullable|max:50', 
            '42'=>'nullable|max:50', 
            '43'=>'nullable|max:50', 
            '44'=>'nullable|max:50', 
            '45'=>'nullable|max:50', 
            '46'=>'nullable|max:50', 
            '47'=>'nullable|max:50', 
            '48'=>'nullable|max:50', 
            '49'=>'nullable|max:50', 
            '50'=>'nullable|max:50', 
            '51'=>'nullable|max:50', 
            '52'=>'nullable|max:50', 
            '53'=>'nullable|max:50', 
            '54'=>'nullable|max:50', 
            '55'=>'nullable|max:50', 
            '56'=>'nullable|max:50', 
            '57'=>'nullable|max:50', 
            '58'=>'nullable|max:50', 
            '59'=>'nullable|max:50', 
            '60'=>'nullable|max:50', 
            '61'=>'nullable|max:50', 
            '62'=>'nullable|max:50', 
            '63'=>'nullable|max:50', 
            '64'=>'nullable|max:50', 
            '65'=>'nullable|max:50', 
            '66'=>'nullable|max:50', 
            '67'=>'nullable|max:50', 
            '68'=>'nullable|max:50', 
            '69'=>'nullable|max:50', 
            '70'=>'nullable|max:50', 
            '71'=>'nullable|max:50', 
            '72'=>'nullable|max:50', 
            '73'=>'nullable|max:50', 
            '74'=>'nullable|max:50', 
            '75'=>'nullable|max:50', 
            '76'=>'nullable|max:50', 
            '77'=>'nullable|max:50', 
            '78'=>'nullable|max:50', 
            '79'=>'nullable|max:50', 
            '80'=>'nullable|max:50', 
            '81'=>'nullable|max:50', 
            '82'=>'nullable|max:50', 
            '83'=>'nullable|max:50', 
            '84'=>'nullable|max:50', 
            '85'=>'nullable|max:50', 
            '86'=>'nullable|max:50', 
            '87'=>'nullable|max:50', 
            '88'=>'nullable|max:50', 
            '89'=>'nullable|max:50', 
            '90'=>'nullable|max:50', 
            '91'=>'nullable|max:100', 
            '92'=>'nullable|max:100', 
            '93'=>'nullable|max:100', 
            '94'=>'nullable|max:100',  
            '95'=>'nullable|max:100',  
            '96'=>'nullable|max:100',  
            '97'=>'nullable|max:100',  
            '98'=>'nullable|max:100',  
            '99'=>'nullable|max:100',  
            '100'=>'nullable|max:100',  
            '101'=>'nullable|max:100',  
            '102'=>'nullable|max:100',  
            '103'=>'nullable|max:100', 
            '104'=>'nullable|max:100', 
            '105'=>'nullable|max:100', 
            '106'=>'nullable|max:100', 
            '107'=>'nullable|max:100', 
            '108'=>'nullable|max:100', 
            '109'=>'nullable|max:100', 
            '110'=>'nullable|max:100', 
            '111'=>'nullable|max:100', 
            '112'=>'nullable|max:100', 
            '113'=>'nullable|max:100', 
            '114'=>'nullable',  
            '115'=>'nullable|max:60',   
            '116'=>'nullable|max:100', 
            '117'=>'nullable|max:100',    
            '118'=>'nullable',   
            '119'=>'nullable',    
            '120'=>'nullable|max:60', 
            '121'=>'nullable' 
        ];
    }

    public  function customValidationAttributes()
    {
        return [
            '0'=>'doc_id',  
            '1'=>'sort_order',  
            '2'=>'brutto',  
            '3'=>'brutto_calc', 
            '4'=>'vat', 
            '5'=>'vat_pros',    
            '6'=>'accepted',    
            '7'=>'acceptor_id', 
            '8'=>'accepted_date',   
            '9'=>'t1',  
            '10'=>'t2',  
            '11'=>'t3',  
            '12'=>'t4',  
            '13'=>'t5',  
            '14'=>'t6',  
            '15'=>'t7',  
            '16'=>'t8',  
            '17'=>'t9',  
            '18'=>'t10', 
            '19'=>'t11', 
            '20'=>'t12', 
            '21'=>'t13', 
            '22'=>'t14', 
            '23'=>'t15', 
            '24'=>'t16', 
            '25'=>'t17', 
            '26'=>'t18', 
            '27'=>'t19', 
            '28'=>'t20', 
            '29'=>'t21', 
            '30'=>'t22', 
            '31'=>'t23', 
            '32'=>'t24', 
            '33'=>'t25', 
            '34'=>'t26', 
            '35'=>'t27', 
            '36'=>'t28', 
            '37'=>'t29', 
            '38'=>'t30', 
            '39'=>'t31', 
            '40'=>'t32', 
            '41'=>'t33', 
            '42'=>'t34', 
            '43'=>'t35', 
            '44'=>'t36', 
            '45'=>'t37', 
            '46'=>'t38', 
            '47'=>'t39', 
            '48'=>'t40', 
            '49'=>'t41', 
            '50'=>'t42', 
            '51'=>'t43', 
            '52'=>'t44', 
            '53'=>'t45', 
            '54'=>'t46', 
            '55'=>'t47', 
            '56'=>'t48', 
            '57'=>'t49', 
            '58'=>'t50', 
            '59'=>'t51', 
            '60'=>'t52', 
            '61'=>'t53', 
            '62'=>'t54', 
            '63'=>'t55', 
            '64'=>'t56', 
            '65'=>'t57', 
            '66'=>'t58', 
            '67'=>'t59', 
            '68'=>'t60', 
            '69'=>'t61', 
            '70'=>'t62', 
            '71'=>'t63', 
            '72'=>'t64', 
            '73'=>'t65', 
            '74'=>'t66', 
            '75'=>'t67', 
            '76'=>'t68', 
            '77'=>'t69', 
            '78'=>'t70', 
            '79'=>'t71', 
            '80'=>'t72', 
            '81'=>'t73', 
            '82'=>'t74', 
            '83'=>'t75', 
            '84'=>'t76', 
            '85'=>'t77', 
            '86'=>'t78', 
            '87'=>'t79', 
            '88'=>'t80', 
            '89'=>'t81', 
            '90'=>'t82', 
            '91'=>'t83', 
            '92'=>'t84', 
            '93'=>'t85', 
            '94'=>'n1',  
            '95'=>'n2',  
            '96'=>'n3',  
            '97'=>'n4',  
            '98'=>'n5',  
            '99'=>'n6',  
            '100'=>'n7',  
            '101'=>'n8',  
            '102'=>'n9',  
            '103'=>'n10', 
            '104'=>'n11', 
            '105'=>'n12', 
            '106'=>'n13', 
            '107'=>'n14', 
            '108'=>'n15', 
            '109'=>'n16', 
            '110'=>'n17', 
            '111'=>'n18', 
            '112'=>'n19', 
            '113'=>'n20', 
            '114'=>'stamp_date',  
            '115'=>'stamp_uid',   
            '116'=>'net_sum', 
            '117'=>'net_calc',    
            '118'=>'layer',   
            '119'=>'reviewed',    
            '120'=>'reviewer_id', 
            '121'=>'reviewed_date' 
        ];
    }


}

